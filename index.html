<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no" />
<title>Kleuter Cijfer Pop</title>
<style>
  :root{
    --bg1: #f3f1ff;
    --bg2: #eaf7ff;
    --ink: #0b1020;
    --bubble-hl: #ffffff;
    --bubble-mid: #eff9ff;
    --bubble-lo: #d6f0ff;
    --bubble-glow: rgba(255,255,255,.85);
  }
  *{ box-sizing:border-box; -webkit-tap-highlight-color: rgba(0,0,0,0) }
  html, body{
    margin:0; height:100%;
    background:#fff; color:var(--ink);
    font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    overscroll-behavior: none; touch-action: none;
  }
  #app{
    position:fixed; inset:0; width:100vw; height:100vh; overflow:hidden;
    background: radial-gradient(120% 120% at 70% 20%, var(--bg1) 0%, var(--bg2) 60%, #ffffff 100%);
    transition: background .6s ease;
  }

  .parallax{ position:absolute; inset:-10%; pointer-events:none; filter: blur(20px); opacity:.35 }
  .blob{ position:absolute; width: 35vmax; height:35vmax; border-radius:50%;
    background: radial-gradient(circle at 35% 35%, rgba(255,255,255,.65), rgba(255,255,255,0));
    animation: float 38s linear infinite; mix-blend-mode: screen }
  .blob.b2{ width:28vmax; height:28vmax; animation-duration:46s; opacity:.28 }
  .blob.b3{ width:40vmax; height:40vmax; animation-duration:52s; opacity:.26 }
  @keyframes float{ 0%{transform:translate3d(-10%,-10%,0)} 50%{transform:translate3d(10%,8%,0)} 100%{transform:translate3d(-10%,-10%,0)} }

  .ui{ position:absolute; left:0; right:0; top: env(safe-area-inset-top, 0px); display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px 16px }
  .badge{ padding:10px 14px; border-radius:9999px; background: rgba(0,0,0,.06); border:1px solid rgba(0,0,0,.05); font-weight:900; font-size: clamp(14px, 2.2vmin, 18px) }
  .controls{ display:flex; gap:10px }
  .iconbtn{ display:flex; align-items:center; gap:10px; border:0; border-radius:9999px; padding:12px 16px; font-weight:900; font-size: clamp(14px, 2.2vmin, 18px); color:var(--ink); background: rgba(0,0,0,.08); border:1px solid rgba(0,0,0,.06); cursor:pointer }
  .iconbtn svg{ width:22px; height:22px }
  .roundbtn{ width:48px; height:48px; border-radius:9999px; display:grid; place-items:center; border:0; background: radial-gradient(circle at 30% 30%, #ffffff, #e9f3ff 70%); box-shadow: 0 6px 16px rgba(0,0,0,.12), inset 0 1px 0 rgba(255,255,255,.9); cursor:pointer }
  .roundbtn svg{ width:22px; height:22px }

  #startOverlay{ position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:18px; padding:24px; background: linear-gradient(180deg, rgba(255,255,255,.4), rgba(255,255,255,.7)); backdrop-filter: blur(4px); text-align:center }
  #startOverlay.hidden{ display:none }
  #startOverlay .title{ font-size: clamp(22px, 3.8vmin, 30px); font-weight:1000 }
  #startOverlay .hint{ font-size: clamp(14px, 2.2vmin, 18px); opacity:.9 }

  .bubble{
    position:absolute; display:grid; place-items:center; border-radius:9999px;
    font-weight:1000; font-size: clamp(38px, 6.6vmin, 64px); color:#0b1020;
    background: radial-gradient(140% 140% at 30% 25%, var(--bubble-hl) 0%, var(--bubble-mid) 40%, var(--bubble-lo) 100%);
    border:2px solid rgba(255,255,255,.9);
    box-shadow: inset 0 1px 1px rgba(255,255,255,.8), inset 0 -10px 18px rgba(0,0,0,.08), 0 12px 28px rgba(0,0,0,.12);
    transform: translate3d(0,0,0) scale(1);
    will-change: transform; user-select:none; -webkit-user-select:none; transition: transform .16s ease;
  }
  .bubble::before{ content:""; position:absolute; inset:-18%; border-radius:inherit; background: radial-gradient(circle at 50% 50%, var(--bubble-glow), rgba(255,255,255,0) 60%); filter: blur(10px); z-index:-1 }
  .bubble::after{ content:""; position:absolute; top:12%; left:18%; width:28%; height:22%; border-radius:9999px; background: rgba(255,255,255,.65); filter: blur(1px); transform: rotate(12deg); pointer-events:none }

  .pop{ animation: pop .33s cubic-bezier(.2,.9,.2,1) forwards }
  @keyframes pop{ 0%{transform: var(--t) scale(1) rotate(0); opacity:1} 45%{transform: var(--t) scale(1.25) rotate(5deg)} 100%{transform: var(--t) scale(.4) rotate(-10deg); opacity:0} }
  .ring{ position:absolute; pointer-events:none; border-radius:9999px; border:3px solid rgba(0,0,0,.12); transform: translate(-50%,-50%) scale(.6); opacity:.9; animation: ring .45s ease-out forwards }
  @keyframes ring{ to{ transform: translate(-50%,-50%) scale(1.45); opacity:0 } }
  .dot{ position:absolute; width:12px; height:12px; border-radius:9999px; opacity:.95; transform: translate(-50%,-50%) scale(1); animation: dot .55s ease-out forwards }
  @keyframes dot{ to{ transform: translate(var(--dx), var(--dy)) scale(.8); opacity:0 } }

  .helper{ position:absolute; width:64px; height:64px; transform: translate(-50%,-50%); pointer-events:none; opacity:0; transition: opacity .25s ease }
  .helper.show{ opacity:.9 }
  .helper .hand{ width:100%; height:100%; animation: nod 1.2s ease-in-out infinite }
  @keyframes nod{ 0%,100%{ transform: translateY(0) rotate(0) } 50%{ transform: translateY(6px) rotate(2deg) } }

  #toast{ position:absolute; left:50%; transform: translateX(-50%); bottom: calc(16px + env(safe-area-inset-bottom, 0px)); padding:10px 14px; background: rgba(0,0,0,.08); border:1px solid rgba(0,0,0,.06); color:var(--ink); border-radius:12px; font-weight:900; font-size:14px; opacity:0; transition: opacity .25s ease; pointer-events:none }
  #toast.show{ opacity:1 }

  .teacher-toggle{ position:absolute; left:12px; bottom: calc(12px + env(safe-area-inset-bottom, 0px)); display:flex; gap:8px }
  .chip{ border:1px solid rgba(0,0,0,.10); background: rgba(0,0,0,.06); padding:8px 10px; border-radius:9999px; font-weight:800; cursor:pointer }
  .panel{ position:absolute; left:12px; bottom: calc(60px + env(safe-area-inset-bottom, 0px)); width: min(92vw, 420px); background: rgba(255,255,255,.95); border:1px solid rgba(0,0,0,.08); border-radius:16px; box-shadow: 0 10px 28px rgba(0,0,0,.12); padding:12px; display:none }
  .panel.show{ display:block }
  .panel h3{ margin:6px 6px 10px; font-size:16px }
  .row{ display:flex; align-items:center; gap:10px; margin:10px 6px }
  .row label{ width:160px; font-weight:800; font-size:14px }
  .row input[type="range"]{ flex:1 }
  .row input[type="number"]{ width:90px; padding:6px 8px; border-radius:10px; border:1px solid rgba(0,0,0,.15) }
  .panel .actions{ display:flex; gap:8px; justify-content:flex-end; margin-top:10px }
  .panel button{ padding:8px 12px; border-radius:10px; border:1px solid rgba(0,0,0,.1); background: rgba(0,0,0,.06); font-weight:900; cursor:pointer }

  .slide-in{ transition: transform .9s cubic-bezier(.2,.9,.2,1) }
</style>
</head>
<body>
  <div id="app" role="application" aria-label="Kleuter Cijfer Pop">
    <div class="parallax" aria-hidden="true">
      <div class="blob" style="left:-8%; top:-6%"></div>
      <div class="blob b2" style="right:-6%; top:10%"></div>
      <div class="blob b3" style="left:20%; bottom:-12%"></div>
    </div>

    <div class="ui">
      <div class="badge" id="badge">Tik het getal op volgorde</div>
      <div class="controls">
        <button class="iconbtn" id="speakBtn" type="button" aria-label="Lees voor">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 18c0 2 1.5 3 3 3s3-1 3-3c0-3 3-3 3-7a6 6 0 0 0-12 0"/>
            <path d="M9 9a3 3 0 0 1 6 0"/>
          </svg>
          Lees voor
        </button>
        <button class="roundbtn" id="resetBtn" type="button" aria-label="Opnieuw">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12a9 9 0 1 0 9-9"/>
            <path d="M3 4v8h8"/>
          </svg>
        </button>
      </div>
    </div>

    <div id="helper" class="helper" aria-hidden="true">
      <svg class="hand" viewBox="0 0 128 128">
        <g fill="#ffd7b8" stroke="#ccab93" stroke-width="2">
          <path d="M38 54c-6 2-9 8-8 14 2 10 10 21 18 28 9 8 20 12 31 11 7 0 12-6 12-13l-1-22c0-3-3-5-6-5h-6l1-8c0-3-2-6-5-6s-5 3-5 6v8h-4l1-10c0-3-2-6-5-6s-5 3-5 6v10h-4l1-10c0-3-2-6-5-6s-5 3-5 6v11z"/>
        </g>
        <circle cx="94" cy="94" r="10" fill="rgba(0,0,0,.10)"/>
      </svg>
    </div>

    <div id="startOverlay" aria-modal="true" role="dialog">
      <div class="title">Klaar voor het spel</div>
      <div class="hint">Klik de cijfers, op volgorde</div>
      <button class="iconbtn" id="startBtn" type="button">▶ Start</button>
    </div>

    <div id="toast" role="status" aria-live="polite"></div>

    <div class="teacher-toggle">
      <button class="chip" id="teacherBtn" type="button">Leerkracht</button>
    </div>

    <div class="panel" id="teacherPanel" role="dialog" aria-label="Leerkracht instellingen">
      <h3>Instellingen</h3>
      <div class="row"><label for="maxWave">Maximaal cijfer</label><input id="maxWave" type="number" min="3" max="20" step="1" /></div>
      <div class="row"><label for="delay">Tijd tussen levels, seconden</label><input id="delay" type="number" min="0" max="5" step="0.5" /></div>
      <div class="row"><label>Snelheid bubbels</label><input id="minSpeed" type="range" min="4" max="40" step="1" /><input id="maxSpeed" type="range" min="6" max="50" step="1" /></div>

      <div class="row" style="align-items:flex-start">
        <label>Bekijk log</label>
        <div>
          <button id="previewBtn" type="button" style="padding:8px 12px; border-radius:10px; border:1px solid rgba(0,0,0,.1); background: rgba(0,0,0,.06); font-weight:900; cursor:pointer">Open</button>
          <div style="font-size:12px; opacity:.8; margin-top:6px">Log toont alleen fouten, velden level en “wist niet”</div>
        </div>
      </div>

      <div class="actions"><button id="saveTeacher" type="button">Bewaar</button><button id="closeTeacher" type="button">Sluit</button></div>
    </div>
  </div>

<script>
;(() => {
  const app = document.getElementById('app')
  const startOverlay = document.getElementById('startOverlay')
  const startBtn = document.getElementById('startBtn')
  const speakBtn = document.getElementById('speakBtn')
  const resetBtn = document.getElementById('resetBtn')
  const toast = document.getElementById('toast')
  const badge = document.getElementById('badge')
  const helper = document.getElementById('helper')

  const teacherBtn = document.getElementById('teacherBtn')
  const teacherPanel = document.getElementById('teacherPanel')
  const saveTeacher = document.getElementById('saveTeacher')
  const closeTeacher = document.getElementById('closeTeacher')
  const inputMaxWave = document.getElementById('maxWave')
  const inputDelay = document.getElementById('delay')
  const inputMinSpeed = document.getElementById('minSpeed')
  const inputMaxSpeed = document.getElementById('maxSpeed')
  const previewBtn = document.getElementById('previewBtn')

  const PASTELS = [
    ['#fde2e4', '#fff1f1'], ['#dfe7fd', '#eef3ff'], ['#e4f1e1', '#f2faef'],
    ['#fff4cc', '#fff9e6'], ['#f3e8ff', '#f9f2ff'], ['#eaf7ff', '#f5fbff'],
    ['#ffe9f2', '#fff3f8'], ['#e9fff5', '#f3fffa'], ['#fff0e6', '#fff7f2'], ['#eef7ff', '#f6fbff']
  ]
  const NUM_WORDS_NL = {0:'nul',1:'één',2:'twee',3:'drie',4:'vier',5:'vijf',6:'zes',7:'zeven',8:'acht',9:'negen',10:'tien',11:'elf',12:'twaalf',13:'dertien',14:'veertien',15:'vijftien',16:'zestien',17:'zeventien',18:'achttien',19:'negentien',20:'twintig'}

  const SETTINGS_KEY = 'kleuter_cijferpop_settings'
  const LOG_KEY = 'kleuter_cijferpop_log_v2'

  // ---------- Storage abstractie met fallback ----------
  const storage = (() => {
    let ok = true
    try{
      const t = '__test__' + Math.random()
      localStorage.setItem(t,'1')
      if(localStorage.getItem(t)!=='1') ok = false
      localStorage.removeItem(t)
    }catch(e){ ok = false }
    let mem = []
    // probeer window.name als simpele persist
    function readName(){
      try{
        const obj = JSON.parse(window.name || '{}')
        return obj && Array.isArray(obj[LOG_KEY]) ? obj[LOG_KEY] : []
      }catch(e){ return [] }
    }
    function writeName(arr){
      try{
        const obj = JSON.parse(window.name || '{}')
        obj[LOG_KEY] = arr
        window.name = JSON.stringify(obj)
      }catch(e){}
    }
    return {
      getLog(){
        if(ok){
          try{ return JSON.parse(localStorage.getItem(LOG_KEY) || '[]') }catch(e){ return [] }
        }else{
          if(mem.length === 0) mem = readName()
          return mem
        }
      },
      setLog(arr){
        if(ok){
          try{ localStorage.setItem(LOG_KEY, JSON.stringify(arr)) }catch(e){}
        }else{
          mem = arr.slice()
          writeName(mem)
        }
      },
      clearLog(){
        if(ok){ try{ localStorage.removeItem(LOG_KEY) }catch(e){} }
        else{ mem = []; writeName(mem) }
      },
      available: ok
    }
  })()

  const state = {
    moving: false,
    wave: 1,
    requiredNext: 1,
    maxWave: 10,
    bubbles: [],
    velocities: [],
    jerkMeta: new Map(),
    runningRAF: 0,
    lastTime: 0,
    voice: null,
    voiceReady: false,
    minSpeed: 10,
    maxSpeed: 22,
    minSize: 110,
    maxSize: 190,
    interLevelDelay: 0.5,
    logging: true,
    idleMs: 5000,
    lastInteraction: 0,
    speakQueue: []
  }

  function clampNum(v,a,b){ return Math.max(a, Math.min(b, v)) }
  function clampInt(v,a,b){ return Math.max(a, Math.min(b, v|0)) }
  function rand(min,max){ return Math.random() * (max - min) + min }

  function setPastelForWave(wave){
    const pair = PASTELS[(wave - 1) % PASTELS.length]
    document.documentElement.style.setProperty('--bg1', pair[0])
    document.documentElement.style.setProperty('--bg2', pair[1])
  }

  function resize(){ app.style.width = innerWidth + 'px'; app.style.height = innerHeight + 'px' }
  addEventListener('resize', resize, {passive:true})
  addEventListener('orientationchange', () => setTimeout(resize, 250))

  function showToast(msg){
    toast.textContent = msg
    toast.classList.add('show')
    clearTimeout(showToast._t)
    showToast._t = setTimeout(() => toast.classList.remove('show'), 1100)
  }

  // ---------- Spraak ----------
  function loadVoices(){
    return new Promise(resolve => {
      const have = speechSynthesis.getVoices()
      if(have.length) resolve(have)
      else speechSynthesis.onvoiceschanged = () => resolve(speechSynthesis.getVoices())
    })
  }
  function isFemaleName(name=''){ return /(claire|saskia|ellen|lotte|femke|mila|maja|vrouw|female|woman)/i.test(name) }
  function pickDutchFemale(vs){
    const nl = vs.filter(v => v.lang && v.lang.toLowerCase().startsWith('nl'))
    const fem = nl.filter(v => isFemaleName(v.name))
    return fem[0] || nl[0] || vs.find(v => isFemaleName(v.name)) || vs[0] || null
  }
  function word(n){ return NUM_WORDS_NL[n] || String(n) }

  // éénmalige unlock bij eerste user gesture
  let didUnlock = false
  async function unlockSpeech(){
    if(didUnlock) return
    didUnlock = true
    try{
      // stille utterance triggert permissie
      const u0 = new SpeechSynthesisUtterance(' ')
      u0.lang = 'nl-NL'
      u0.volume = 0
      speechSynthesis.speak(u0)
    }catch(e){}
    try{
      const voices = await loadVoices()
      state.voice = pickDutchFemale(voices)
    }catch(e){}
    state.voiceReady = true
    flushSpeakQueue()
  }
  function attachFirstGestureUnlock(){
    const once = () => {
      document.removeEventListener('pointerdown', once, {passive:true})
      document.removeEventListener('keydown', once)
      unlockSpeech()
    }
    document.addEventListener('pointerdown', once, {passive:true})
    document.addEventListener('keydown', once)
  }

  function flushSpeakQueue(){
    if(!state.voiceReady) return
    if(!state.speakQueue.length) return
    const items = state.speakQueue.slice()
    state.speakQueue.length = 0
    for(const [text, rate] of items){ doSpeak(text, rate) }
  }
  function doSpeak(text, rate){
    try{
      // normaal gesproken cancel, maar niet als het alleen de unlock is
      speechSynthesis.cancel()
      const u = new SpeechSynthesisUtterance(text)
      u.lang = 'nl-NL'
      u.rate = rate
      if(state.voice) u.voice = state.voice
      speechSynthesis.speak(u)
    }catch(e){}
  }
  function speak(text, rate=1.10){
    if(!state.voiceReady){
      state.speakQueue.push([text, rate])
      return
    }
    doSpeak(text, rate)
  }

  // ---------- Settings ----------
  function loadSettings(){
    try{
      const raw = localStorage.getItem(SETTINGS_KEY)
      if(raw){
        const s = JSON.parse(raw)
        if(typeof s.maxWave === 'number') state.maxWave = s.maxWave
        if(typeof s.interLevelDelay === 'number') state.interLevelDelay = s.interLevelDelay
        if(typeof s.minSpeed === 'number') state.minSpeed = s.minSpeed
        if(typeof s.maxSpeed === 'number') state.maxSpeed = s.maxSpeed
      }
    }catch(e){}
    inputMaxWave.value = state.maxWave
    inputDelay.value = state.interLevelDelay
    inputMinSpeed.value = state.minSpeed
    inputMaxSpeed.value = state.maxSpeed
  }
  function saveSettings(){
    state.maxWave = clampInt(parseInt(inputMaxWave.value,10), 3, 20)
    state.interLevelDelay = clampNum(parseFloat(inputDelay.value), 0, 5)
    state.minSpeed = clampNum(parseFloat(inputMinSpeed.value), 2, 40)
    state.maxSpeed = clampNum(parseFloat(inputMaxSpeed.value), state.minSpeed+1, 50)
    try{
      localStorage.setItem(SETTINGS_KEY, JSON.stringify({
        maxWave: state.maxWave, interLevelDelay: state.interLevelDelay,
        minSpeed: state.minSpeed, maxSpeed: state.maxSpeed
      }))
    }catch(e){}
    showToast('Instellingen bewaard')
  }

  // ---------- Logging met fallback ----------
  function logError(level, need){
    const entry = { level, 'wist niet': need }
    try{
      const arr = storage.getLog()
      arr.push(entry)
      storage.setLog(arr)
    }catch(e){}
  }
  function previewLog(){
    const arr = storage.getLog()
    const pretty = arr.length ? JSON.stringify(arr, null, 2) : '[]'
    const safe = pretty.replace(/[<>&]/g, s => ({'<':'&lt;','>':'&gt;','&':'&amp;'}[s]))
    const html = `<pre style="white-space:pre-wrap;padding:16px;font:14px/1.4 ui-monospace,SFMono-Regular,Menlo,monospace;">${safe}</pre>`
    const w = window.open('', '_blank')
    if(w){ w.document.write(`<title>Foutenlog</title>${html}`); w.document.close() } else { alert('Kan geen venster openen, mogelijk blokkeert je browser dit') }
  }

  // ---------- Helperhand ----------
  function hideHelper(){ helper.classList.remove('show') }
  function maybeShowHelper(){
    const now = performance.now()
    if(now - state.lastInteraction < state.idleMs) return
    let minB = null, minN = Infinity
    for(const b of state.bubbles){
      const n = parseInt(b.dataset.num,10)
      if(n < minN){ minN = n; minB = b }
    }
    if(!minB) return
    const r = minB.getBoundingClientRect()
    helper.style.left = r.left + r.width*0.2 + 'px'
    helper.style.top  = r.top  + r.height*0.2 + 'px'
    helper.classList.add('show')
  }
  function registerInteraction(){ state.lastInteraction = performance.now(); hideHelper() }
  document.addEventListener('pointerdown', registerInteraction, {passive:true})

  // ---------- Bubbels ----------
  function clearBubbles(){
    for(const b of state.bubbles){ b.removeEventListener('pointerdown', onBubbleTap); b.remove() }
    state.bubbles = []; state.velocities = []; state.jerkMeta.clear()
  }
  function setTransform(el, x, y){
    el.style.setProperty('--t', `translate3d(${x}px, ${y}px, 0)`)
    el.style.transform = `translate3d(${x}px, ${y}px, 0)`
  }
  function overlapsExisting(x,y,size){
    for(const b of state.bubbles){
      const bx = parseFloat(b.dataset.x), by = parseFloat(b.dataset.y), bs = parseFloat(b.dataset.size)
      const dx = (bx + bs*.5) - (x + size*.5), dy = (by + bs*.5) - (y + size*.5)
      const rr = (bs*.5 + size*.5); if(dx*dx + dy*dy < rr*rr * 0.92) return true
    }
    return false
  }

  function createWaveBubbles(){
    clearBubbles()
    const W = app.clientWidth, H = app.clientHeight, pad = 16
    for(let n=1; n<=state.wave; n++){
      const el = document.createElement('div')
      el.className = 'bubble'; el.textContent = n; el.dataset.num = n
      const baseMin = Math.max(110, Math.min(innerWidth, innerHeight) * 0.16)
      const baseMax = Math.max(190, Math.min(innerWidth, innerHeight) * 0.26)
      const size = Math.floor(rand(baseMin, baseMax))
      el.style.width = size + 'px'; el.style.height = size + 'px'
      el.style.zIndex = String(1000 - n)

      let x = rand(pad, Math.max(pad, W - size)), y = rand(pad + 70, Math.max(pad + 70, H - size)), tries = 0
      while(overlapsExisting(x,y,size) && tries < 240){
        x = rand(pad, Math.max(pad, W - size)); y = rand(pad + 70, Math.max(pad + 70, H - size)); tries++
      }
      setTransform(el, x, y)
      el.dataset.x = x; el.dataset.y = y; el.dataset.size = size
      el.addEventListener('pointerdown', onBubbleTap, {passive:true})

      const sp = rand(state.minSpeed, state.maxSpeed), ang = rand(0, Math.PI*2)
      const v = { vx: Math.cos(ang)*sp, vy: Math.sin(ang)*sp }

      app.appendChild(el)
      state.bubbles.push(el); state.velocities.push(v)
      state.jerkMeta.set(el, { nextJerk: performance.now() + rand(300, 800) })
    }
    enforceStacking()
  }

  function enforceStacking(){
    let minN = Infinity
    for(const b of state.bubbles){ const n = parseInt(b.dataset.num,10); if(n < minN) minN = n }
    for(const b of state.bubbles){ const n = parseInt(b.dataset.num,10); b.style.zIndex = String(1000 - n) }
    const minB = state.bubbles.find(b => parseInt
